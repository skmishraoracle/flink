2024-11-26 03:51:09,167 - INFO - Using Any for unsupported type: typing.Sequence[~T]
2024-11-26 03:51:09,282 - INFO - No module named google.cloud.bigquery_storage_v1. As a result, the ReadFromBigQuery transform *CANNOT* be used with `method=DIRECT_READ`.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1732621869.332965 5626692 trace.cc:89] Unknown tracer: none
[                       0%                       ][************          25%                       ]  2 of 8 completed[******************    38%                       ]  3 of 8 completed[**********************50%                       ]  4 of 8 completed[**********************62%*****                  ]  5 of 8 completed[**********************62%*****                  ]  5 of 8 completed[**********************88%*****************      ]  7 of 8 completed[*********************100%***********************]  8 of 8 completed
[datetime.datetime(2024, 1, 2, 0, 0), datetime.datetime(2024, 1, 3, 0, 0), datetime.datetime(2024, 1, 4, 0, 0), datetime.datetime(2024, 1, 5, 0, 0), datetime.datetime(2024, 1, 8, 0, 0), datetime.datetime(2024, 1, 9, 0, 0), datetime.datetime(2024, 1, 10, 0, 0), datetime.datetime(2024, 1, 11, 0, 0), datetime.datetime(2024, 1, 12, 0, 0), datetime.datetime(2024, 1, 16, 0, 0), datetime.datetime(2024, 1, 17, 0, 0), datetime.datetime(2024, 1, 18, 0, 0), datetime.datetime(2024, 1, 19, 0, 0), datetime.datetime(2024, 1, 22, 0, 0), datetime.datetime(2024, 1, 23, 0, 0), datetime.datetime(2024, 1, 24, 0, 0), datetime.datetime(2024, 1, 25, 0, 0), datetime.datetime(2024, 1, 26, 0, 0), datetime.datetime(2024, 1, 29, 0, 0), datetime.datetime(2024, 1, 30, 0, 0), datetime.datetime(2024, 1, 31, 0, 0), datetime.datetime(2024, 2, 1, 0, 0), datetime.datetime(2024, 2, 2, 0, 0), datetime.datetime(2024, 2, 5, 0, 0), datetime.datetime(2024, 2, 6, 0, 0), datetime.datetime(2024, 2, 7, 0, 0), datetime.datetime(2024, 2, 8, 0, 0), datetime.datetime(2024, 2, 9, 0, 0), datetime.datetime(2024, 2, 12, 0, 0), datetime.datetime(2024, 2, 13, 0, 0), datetime.datetime(2024, 2, 14, 0, 0), datetime.datetime(2024, 2, 15, 0, 0), datetime.datetime(2024, 2, 16, 0, 0), datetime.datetime(2024, 2, 20, 0, 0), datetime.datetime(2024, 2, 21, 0, 0), datetime.datetime(2024, 2, 22, 0, 0), datetime.datetime(2024, 2, 23, 0, 0), datetime.datetime(2024, 2, 26, 0, 0), datetime.datetime(2024, 2, 27, 0, 0), datetime.datetime(2024, 2, 28, 0, 0), datetime.datetime(2024, 2, 29, 0, 0), datetime.datetime(2024, 3, 1, 0, 0), datetime.datetime(2024, 3, 4, 0, 0), datetime.datetime(2024, 3, 5, 0, 0), datetime.datetime(2024, 3, 6, 0, 0), datetime.datetime(2024, 3, 7, 0, 0), datetime.datetime(2024, 3, 8, 0, 0), datetime.datetime(2024, 3, 11, 0, 0), datetime.datetime(2024, 3, 12, 0, 0), datetime.datetime(2024, 3, 13, 0, 0), datetime.datetime(2024, 3, 14, 0, 0), datetime.datetime(2024, 3, 15, 0, 0), datetime.datetime(2024, 3, 18, 0, 0), datetime.datetime(2024, 3, 19, 0, 0), datetime.datetime(2024, 3, 20, 0, 0), datetime.datetime(2024, 3, 21, 0, 0), datetime.datetime(2024, 3, 22, 0, 0), datetime.datetime(2024, 3, 25, 0, 0), datetime.datetime(2024, 3, 26, 0, 0), datetime.datetime(2024, 3, 27, 0, 0), datetime.datetime(2024, 3, 28, 0, 0), datetime.datetime(2024, 4, 1, 0, 0), datetime.datetime(2024, 4, 2, 0, 0), datetime.datetime(2024, 4, 3, 0, 0), datetime.datetime(2024, 4, 4, 0, 0), datetime.datetime(2024, 4, 5, 0, 0), datetime.datetime(2024, 4, 8, 0, 0), datetime.datetime(2024, 4, 9, 0, 0), datetime.datetime(2024, 4, 10, 0, 0), datetime.datetime(2024, 4, 11, 0, 0), datetime.datetime(2024, 4, 12, 0, 0), datetime.datetime(2024, 4, 15, 0, 0), datetime.datetime(2024, 4, 16, 0, 0), datetime.datetime(2024, 4, 17, 0, 0), datetime.datetime(2024, 4, 18, 0, 0), datetime.datetime(2024, 4, 19, 0, 0), datetime.datetime(2024, 4, 22, 0, 0), datetime.datetime(2024, 4, 23, 0, 0), datetime.datetime(2024, 4, 24, 0, 0), datetime.datetime(2024, 4, 25, 0, 0), datetime.datetime(2024, 4, 26, 0, 0), datetime.datetime(2024, 4, 29, 0, 0), datetime.datetime(2024, 4, 30, 0, 0), datetime.datetime(2024, 5, 1, 0, 0), datetime.datetime(2024, 5, 2, 0, 0), datetime.datetime(2024, 5, 3, 0, 0), datetime.datetime(2024, 5, 6, 0, 0), datetime.datetime(2024, 5, 7, 0, 0), datetime.datetime(2024, 5, 8, 0, 0), datetime.datetime(2024, 5, 9, 0, 0), datetime.datetime(2024, 5, 10, 0, 0), datetime.datetime(2024, 5, 13, 0, 0), datetime.datetime(2024, 5, 14, 0, 0), datetime.datetime(2024, 5, 15, 0, 0), datetime.datetime(2024, 5, 16, 0, 0), datetime.datetime(2024, 5, 17, 0, 0), datetime.datetime(2024, 5, 20, 0, 0), datetime.datetime(2024, 5, 21, 0, 0), datetime.datetime(2024, 5, 22, 0, 0), datetime.datetime(2024, 5, 23, 0, 0), datetime.datetime(2024, 5, 24, 0, 0), datetime.datetime(2024, 5, 28, 0, 0), datetime.datetime(2024, 5, 29, 0, 0), datetime.datetime(2024, 5, 30, 0, 0), datetime.datetime(2024, 5, 31, 0, 0), datetime.datetime(2024, 6, 3, 0, 0), datetime.datetime(2024, 6, 4, 0, 0), datetime.datetime(2024, 6, 5, 0, 0), datetime.datetime(2024, 6, 6, 0, 0), datetime.datetime(2024, 6, 7, 0, 0), datetime.datetime(2024, 6, 10, 0, 0), datetime.datetime(2024, 6, 11, 0, 0), datetime.datetime(2024, 6, 12, 0, 0), datetime.datetime(2024, 6, 13, 0, 0), datetime.datetime(2024, 6, 14, 0, 0), datetime.datetime(2024, 6, 17, 0, 0), datetime.datetime(2024, 6, 18, 0, 0), datetime.datetime(2024, 6, 20, 0, 0), datetime.datetime(2024, 6, 21, 0, 0), datetime.datetime(2024, 6, 24, 0, 0), datetime.datetime(2024, 6, 25, 0, 0), datetime.datetime(2024, 6, 26, 0, 0), datetime.datetime(2024, 6, 27, 0, 0), datetime.datetime(2024, 6, 28, 0, 0), datetime.datetime(2024, 7, 1, 0, 0), datetime.datetime(2024, 7, 2, 0, 0), datetime.datetime(2024, 7, 3, 0, 0), datetime.datetime(2024, 7, 5, 0, 0), datetime.datetime(2024, 7, 8, 0, 0), datetime.datetime(2024, 7, 9, 0, 0), datetime.datetime(2024, 7, 10, 0, 0), datetime.datetime(2024, 7, 11, 0, 0), datetime.datetime(2024, 7, 12, 0, 0), datetime.datetime(2024, 7, 15, 0, 0), datetime.datetime(2024, 7, 16, 0, 0), datetime.datetime(2024, 7, 17, 0, 0), datetime.datetime(2024, 7, 18, 0, 0), datetime.datetime(2024, 7, 19, 0, 0), datetime.datetime(2024, 7, 22, 0, 0), datetime.datetime(2024, 7, 23, 0, 0), datetime.datetime(2024, 7, 24, 0, 0), datetime.datetime(2024, 7, 25, 0, 0), datetime.datetime(2024, 7, 26, 0, 0), datetime.datetime(2024, 7, 29, 0, 0), datetime.datetime(2024, 7, 30, 0, 0), datetime.datetime(2024, 7, 31, 0, 0), datetime.datetime(2024, 8, 1, 0, 0), datetime.datetime(2024, 8, 2, 0, 0), datetime.datetime(2024, 8, 5, 0, 0), datetime.datetime(2024, 8, 6, 0, 0), datetime.datetime(2024, 8, 7, 0, 0), datetime.datetime(2024, 8, 8, 0, 0), datetime.datetime(2024, 8, 9, 0, 0), datetime.datetime(2024, 8, 12, 0, 0), datetime.datetime(2024, 8, 13, 0, 0), datetime.datetime(2024, 8, 14, 0, 0), datetime.datetime(2024, 8, 15, 0, 0), datetime.datetime(2024, 8, 16, 0, 0), datetime.datetime(2024, 8, 19, 0, 0), datetime.datetime(2024, 8, 20, 0, 0), datetime.datetime(2024, 8, 21, 0, 0), datetime.datetime(2024, 8, 22, 0, 0), datetime.datetime(2024, 8, 23, 0, 0), datetime.datetime(2024, 8, 26, 0, 0), datetime.datetime(2024, 8, 27, 0, 0), datetime.datetime(2024, 8, 28, 0, 0), datetime.datetime(2024, 8, 29, 0, 0), datetime.datetime(2024, 8, 30, 0, 0), datetime.datetime(2024, 9, 3, 0, 0), datetime.datetime(2024, 9, 4, 0, 0), datetime.datetime(2024, 9, 5, 0, 0), datetime.datetime(2024, 9, 6, 0, 0), datetime.datetime(2024, 9, 9, 0, 0), datetime.datetime(2024, 9, 10, 0, 0), datetime.datetime(2024, 9, 11, 0, 0), datetime.datetime(2024, 9, 12, 0, 0), datetime.datetime(2024, 9, 13, 0, 0), datetime.datetime(2024, 9, 16, 0, 0), datetime.datetime(2024, 9, 17, 0, 0), datetime.datetime(2024, 9, 18, 0, 0), datetime.datetime(2024, 9, 19, 0, 0), datetime.datetime(2024, 9, 20, 0, 0), datetime.datetime(2024, 9, 23, 0, 0), datetime.datetime(2024, 9, 24, 0, 0), datetime.datetime(2024, 9, 25, 0, 0), datetime.datetime(2024, 9, 26, 0, 0), datetime.datetime(2024, 9, 27, 0, 0), datetime.datetime(2024, 9, 30, 0, 0), datetime.datetime(2024, 10, 1, 0, 0), datetime.datetime(2024, 10, 2, 0, 0), datetime.datetime(2024, 10, 3, 0, 0), datetime.datetime(2024, 10, 4, 0, 0), datetime.datetime(2024, 10, 7, 0, 0), datetime.datetime(2024, 10, 8, 0, 0), datetime.datetime(2024, 10, 9, 0, 0), datetime.datetime(2024, 10, 10, 0, 0), datetime.datetime(2024, 10, 11, 0, 0), datetime.datetime(2024, 10, 14, 0, 0), datetime.datetime(2024, 10, 15, 0, 0), datetime.datetime(2024, 10, 16, 0, 0), datetime.datetime(2024, 10, 17, 0, 0), datetime.datetime(2024, 10, 18, 0, 0), datetime.datetime(2024, 10, 21, 0, 0), datetime.datetime(2024, 10, 22, 0, 0), datetime.datetime(2024, 10, 23, 0, 0), datetime.datetime(2024, 10, 24, 0, 0), datetime.datetime(2024, 10, 25, 0, 0), datetime.datetime(2024, 10, 28, 0, 0), datetime.datetime(2024, 10, 29, 0, 0), datetime.datetime(2024, 10, 30, 0, 0), datetime.datetime(2024, 10, 31, 0, 0), datetime.datetime(2024, 11, 1, 0, 0), datetime.datetime(2024, 11, 4, 0, 0), datetime.datetime(2024, 11, 5, 0, 0), datetime.datetime(2024, 11, 6, 0, 0), datetime.datetime(2024, 11, 7, 0, 0), datetime.datetime(2024, 11, 8, 0, 0), datetime.datetime(2024, 11, 11, 0, 0), datetime.datetime(2024, 11, 12, 0, 0), datetime.datetime(2024, 11, 13, 0, 0), datetime.datetime(2024, 11, 14, 0, 0), datetime.datetime(2024, 11, 15, 0, 0), datetime.datetime(2024, 11, 18, 0, 0), datetime.datetime(2024, 11, 19, 0, 0), datetime.datetime(2024, 11, 20, 0, 0), datetime.datetime(2024, 11, 21, 0, 0), datetime.datetime(2024, 11, 22, 0, 0), datetime.datetime(2024, 11, 25, 0, 0)]
[138.5800018310547, 135.32000732421875, 136.00999450683594, 138.5800018310547, 146.17999267578125, 149.25999450683594, 148.5399932861328, 148.02000427246094, 146.55999755859375, 158.74000549316406, 160.1699981689453, 162.6699981689453, 174.22999572753906, 168.17999267578125, 168.4199981689453, 178.2899932861328, 180.3300018310547, 177.25, 177.8300018310547, 172.05999755859375, 167.69000244140625, 170.47999572753906, 177.66000366210938, 174.22999572753906, 167.8800048828125, 170.94000244140625, 169.35000610351562, 172.47999572753906, 171.91000366210938, 171.5399932861328, 178.6999969482422, 176.75999450683594, 173.8699951171875, 165.69000244140625, 164.2899932861328, 181.86000061035156, 176.52000427246094, 176.00999450683594, 178.0, 176.5399932861328, 192.52999877929688, 202.63999938964844, 205.36000061035156, 205.1300048828125, 210.6300048828125, 211.3800048828125, 207.38999938964844, 198.38999938964844, 202.75999450683594, 194.7899932861328, 187.05999755859375, 191.05999755859375, 190.64999389648438, 181.4199981689453, 179.72999572753906, 178.67999267578125, 179.64999389648438, 178.6300048828125, 177.8699951171875, 179.58999633789062, 180.49000549316406, 183.33999633789062, 178.6999969482422, 180.77000427246094, 165.8300018310547, 170.4199981689453, 169.89999389648438, 170.77999877929688, 167.13999938964844, 170.5, 163.27999877929688, 160.32000732421875, 163.4600067138672, 154.02000427246094, 155.0800018310547, 146.63999938964844, 148.63999938964844, 152.27000427246094, 151.74000549316406, 153.75999450683594, 157.39999389648438, 160.1999969482422, 158.3800048828125, 144.27000427246094, 146.16000366210938, 150.60000610351562, 155.77999877929688, 154.42999267578125, 153.6199951171875, 152.38999938964844, 151.9199981689453, 150.55999755859375, 153.16000366210938, 159.6699981689453, 162.6199951171875, 164.47000122070312, 166.3300018310547, 164.66000366210938, 165.52000427246094, 160.42999267578125, 166.36000061035156, 171.61000061035156, 165.13999938964844, 166.75, 166.89999389648438, 163.5500030517578, 159.99000549316406, 166.1699981689453, 166.77999877929688, 167.8699951171875, 160.33999633789062, 158.9600067138672, 160.24000549316406, 159.89999389648438, 159.6300048828125, 158.39999389648438, 154.6300048828125, 161.77999877929688, 161.22999572753906, 160.25, 160.25, 157.5399932861328, 159.47000122070312, 162.2100067138672, 157.69000244140625, 164.30999755859375, 163.89999389648438, 171.89999389648438, 178.69000244140625, 177.10000610351562, 183.9600067138672, 181.94000244140625, 181.61000061035156, 179.8300018310547, 177.5500030517578, 159.42999267578125, 155.77000427246094, 151.5800018310547, 155.8699951171875, 154.0, 144.6300048828125, 138.32000732421875, 139.99000549316406, 139.75, 138.44000244140625, 144.47999572753906, 132.5399932861328, 132.5, 134.82000732421875, 130.17999267578125, 128.6699981689453, 136.32000732421875, 134.27000427246094, 136.77000427246094, 141.1300048828125, 140.75, 147.36000061035156, 148.55999755859375, 155.27999877929688, 156.39999389648438, 157.80999755859375, 151.6999969482422, 154.97999572753906, 149.99000549316406, 150.5, 146.36000061035156, 145.49000549316406, 148.55999755859375, 136.94000244140625, 140.8699951171875, 139.44000244140625, 134.35000610351562, 138.14999389648438, 142.83999633789062, 149.86000061035156, 150.77000427246094, 152.30999755859375, 152.0800018310547, 150.82000732421875, 148.2899932861328, 156.74000549316406, 155.9499969482422, 156.75, 158.32000732421875, 162.02000427246094, 167.49000549316406, 164.35000610351562, 164.0800018310547, 159.75, 159.77999877929688, 162.85000610351562, 170.89999389648438, 170.97000122070312, 172.8000030517578, 171.02000427246094, 164.17999267578125, 167.88999938964844, 165.27000427246094, 156.63999938964844, 156.1300048828125, 156.25, 155.97000122070312, 157.89999389648438, 154.08999633789062, 152.91000366210938, 153.44000244140625, 156.22999572753906, 159.9199981689453, 166.25, 148.60000610351562, 144.07000732421875, 141.86000061035156, 140.7100067138672, 141.66000366210938, 145.10000610351562, 149.82000732421875, 147.9499969482422, 147.35000610351562, 143.6300048828125, 139.3000030517578, 138.83999633789062, 134.89999389648438, 138.92999267578125, 139.38999938964844, 137.60000610351562, 137.49000549316406, 138.35000610351562, 141.1300048828125]
[138.5800018310547, 135.32000732421875, 136.00999450683594, 138.5800018310547, 146.17999267578125, 149.25999450683594, 148.5399932861328, 148.02000427246094, 146.55999755859375, 158.74000549316406, 160.1699981689453, 162.6699981689453, 174.22999572753906, 168.17999267578125, 168.4199981689453, 178.2899932861328, 180.3300018310547, 177.25, 177.8300018310547, 172.05999755859375, 167.69000244140625, 170.47999572753906, 177.66000366210938, 174.22999572753906, 167.8800048828125, 170.94000244140625, 169.35000610351562, 172.47999572753906, 171.91000366210938, 171.5399932861328, 178.6999969482422, 176.75999450683594, 173.8699951171875, 165.69000244140625, 164.2899932861328, 181.86000061035156, 176.52000427246094, 176.00999450683594, 178.0, 176.5399932861328, 192.52999877929688, 202.63999938964844, 205.36000061035156, 205.1300048828125, 210.6300048828125, 211.3800048828125, 207.38999938964844, 198.38999938964844, 202.75999450683594, 194.7899932861328, 187.05999755859375, 191.05999755859375, 190.64999389648438, 181.4199981689453, 179.72999572753906, 178.67999267578125, 179.64999389648438, 178.6300048828125, 177.8699951171875, 179.58999633789062, 180.49000549316406, 183.33999633789062, 178.6999969482422, 180.77000427246094, 165.8300018310547, 170.4199981689453, 169.89999389648438, 170.77999877929688, 167.13999938964844, 170.5, 163.27999877929688, 160.32000732421875, 163.4600067138672, 154.02000427246094, 155.0800018310547, 146.63999938964844, 148.63999938964844, 152.27000427246094, 151.74000549316406, 153.75999450683594, 157.39999389648438, 160.1999969482422, 158.3800048828125, 144.27000427246094, 146.16000366210938, 150.60000610351562, 155.77999877929688, 154.42999267578125, 153.6199951171875, 152.38999938964844, 151.9199981689453, 150.55999755859375, 153.16000366210938, 159.6699981689453, 162.6199951171875, 164.47000122070312, 166.3300018310547, 164.66000366210938, 165.52000427246094, 160.42999267578125, 166.36000061035156, 171.61000061035156, 165.13999938964844, 166.75, 166.89999389648438, 163.5500030517578, 159.99000549316406, 166.1699981689453, 166.77999877929688, 167.8699951171875, 160.33999633789062, 158.9600067138672, 160.24000549316406, 159.89999389648438, 159.6300048828125, 158.39999389648438, 154.6300048828125, 161.77999877929688, 161.22999572753906, 160.25, 160.25, 157.5399932861328, 159.47000122070312, 162.2100067138672, 157.69000244140625, 164.30999755859375, 163.89999389648438, 171.89999389648438, 178.69000244140625, 177.10000610351562, 183.9600067138672, 181.94000244140625, 181.61000061035156, 179.8300018310547, 177.5500030517578, 159.42999267578125, 155.77000427246094, 151.5800018310547, 155.8699951171875, 154.0, 144.6300048828125, 138.32000732421875, 139.99000549316406, 139.75, 138.44000244140625, 144.47999572753906, 132.5399932861328, 132.5, 134.82000732421875, 130.17999267578125, 128.6699981689453, 136.32000732421875, 134.27000427246094, 136.77000427246094, 141.1300048828125, 140.75, 147.36000061035156, 148.55999755859375, 155.27999877929688, 156.39999389648438, 157.80999755859375, 151.6999969482422, 154.97999572753906, 149.99000549316406, 150.5, 146.36000061035156, 145.49000549316406, 148.55999755859375, 136.94000244140625, 140.8699951171875, 139.44000244140625, 134.35000610351562, 138.14999389648438, 142.83999633789062, 149.86000061035156, 150.77000427246094, 152.30999755859375, 152.0800018310547, 150.82000732421875, 148.2899932861328, 156.74000549316406, 155.9499969482422, 156.75, 158.32000732421875, 162.02000427246094, 167.49000549316406, 164.35000610351562, 164.0800018310547, 159.75, 159.77999877929688, 162.85000610351562, 170.89999389648438, 170.97000122070312, 172.8000030517578, 171.02000427246094, 164.17999267578125, 167.88999938964844, 165.27000427246094, 156.63999938964844, 156.1300048828125, 156.25, 155.97000122070312, 157.89999389648438, 154.08999633789062, 152.91000366210938, 153.44000244140625, 156.22999572753906, 159.9199981689453, 166.25, 148.60000610351562, 144.07000732421875, 141.86000061035156, 140.7100067138672, 141.66000366210938, 145.10000610351562, 149.82000732421875, 147.9499969482422, 147.35000610351562, 143.6300048828125, 139.3000030517578, 138.83999633789062, 134.89999389648438, 138.92999267578125, 139.38999938964844, 137.60000610351562, 137.49000549316406, 138.35000610351562, 141.1300048828125]
Traceback (most recent call last):
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/apache_beam/runners/worker/sdk_worker.py", line 295, in _execute
    response = task()
               ^^^^^^
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/apache_beam/runners/worker/sdk_worker.py", line 370, in <lambda>
    lambda: self.create_worker().do_instruction(request), request)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/apache_beam/runners/worker/sdk_worker.py", line 629, in do_instruction
    return getattr(self, request_type)(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/apache_beam/runners/worker/sdk_worker.py", line 667, in process_bundle
    bundle_processor.process_bundle(instruction_id))
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/apache_beam/runners/worker/bundle_processor.py", line 1058, in process_bundle
    self.ops[element.transform_id].process_timer(
  File "pyflink/fn_execution/beam/beam_operations_fast.pyx", line 263, in pyflink.fn_execution.beam.beam_operations_fast.StatefulFunctionOperation.process_timer
  File "pyflink/fn_execution/beam/beam_operations_fast.pyx", line 272, in pyflink.fn_execution.beam.beam_operations_fast.StatefulFunctionOperation.process_timer
  File "pyflink/fn_execution/beam/beam_operations_fast.pyx", line 104, in pyflink.fn_execution.beam.beam_operations_fast.IntermediateOutputProcessor.process_outputs
  File "pyflink/fn_execution/beam/beam_operations_fast.pyx", line 169, in pyflink.fn_execution.beam.beam_operations_fast.FunctionOperation.process
  File "pyflink/fn_execution/beam/beam_operations_fast.pyx", line 193, in pyflink.fn_execution.beam.beam_operations_fast.FunctionOperation.process
  File "pyflink/fn_execution/beam/beam_operations_fast.pyx", line 65, in pyflink.fn_execution.beam.beam_operations_fast.IntermediateInputProcessor.has_next
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/pyflink/fn_execution/datastream/process/input_handler.py", line 94, in process_timer
    yield from _emit_results(
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/pyflink/fn_execution/datastream/process/input_handler.py", line 131, in _emit_results
    for result in results:
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/pyflink/fn_execution/datastream/process/input_handler.py", line 111, in _on_event_time
    yield from self._on_event_time_func(timestamp, key, namespace)
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/pyflink/fn_execution/datastream/window/window_operator.py", line 455, in on_event_time
    yield from self.emit_window_contents(self.trigger_context.window, contents)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/pyflink/fn_execution/datastream/window/window_operator.py", line 563, in emit_window_contents
    return self.window_function.process(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/pyflink/datastream/functions.py", line 1180, in process
    return self._wrapped_function.apply(key, window, input_data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/skmishra/repo/llms/experiments/flink/base.py", line 111, in apply
    sum(open_prices) / len(open_prices),
    ^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for +: 'int' and 'datetime.datetime'

Traceback (most recent call last):
  File "/Users/skmishra/repo/llms/experiments/flink/base.py", line 83, in ds2pdf_moving_avg
    results = [ ( datetime.fromtimestamp(row[0] / 1000), datetime.fromtimestamp(row[1] / 1000), row[2], row[3], row[4], row[5] ) for row in ds.execute_and_collect() ]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/skmishra/repo/llms/experiments/flink/base.py", line 83, in <listcomp>
    results = [ ( datetime.fromtimestamp(row[0] / 1000), datetime.fromtimestamp(row[1] / 1000), row[2], row[3], row[4], row[5] ) for row in ds.execute_and_collect() ]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/pyflink/datastream/data_stream.py", line 2920, in __next__
    return self.next()
           ^^^^^^^^^^^
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/pyflink/datastream/data_stream.py", line 2929, in next
    if not self._j_closeable_iterator.hasNext():
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/py4j/java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
                   ^^^^^^^^^^^^^^^^^
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/pyflink/util/exceptions.py", line 146, in deco
    return f(*a, **kw)
           ^^^^^^^^^^^
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o537.hasNext.
: java.lang.RuntimeException: Failed to fetch next result
	at org.apache.flink.streaming.api.operators.collect.CollectResultIterator.nextResultFromFetcher(CollectResultIterator.java:129)
	at org.apache.flink.streaming.api.operators.collect.CollectResultIterator.hasNext(CollectResultIterator.java:100)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.apache.flink.api.python.shaded.py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at org.apache.flink.api.python.shaded.py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at org.apache.flink.api.python.shaded.py4j.Gateway.invoke(Gateway.java:282)
	at org.apache.flink.api.python.shaded.py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at org.apache.flink.api.python.shaded.py4j.commands.CallCommand.execute(CallCommand.java:79)
	at org.apache.flink.api.python.shaded.py4j.GatewayConnection.run(GatewayConnection.java:238)
	at java.base/java.lang.Thread.run(Thread.java:1575)
Caused by: java.io.IOException: Failed to fetch job execution result
	at org.apache.flink.streaming.api.operators.collect.CollectResultFetcher.getAccumulatorResults(CollectResultFetcher.java:187)
	at org.apache.flink.streaming.api.operators.collect.CollectResultFetcher.next(CollectResultFetcher.java:123)
	at org.apache.flink.streaming.api.operators.collect.CollectResultIterator.nextResultFromFetcher(CollectResultIterator.java:126)
	... 10 more
Caused by: java.util.concurrent.ExecutionException: org.apache.flink.runtime.client.JobExecutionException: Job execution failed.
	at java.base/java.util.concurrent.CompletableFuture.wrapInExecutionException(CompletableFuture.java:345)
	at java.base/java.util.concurrent.CompletableFuture.reportGet(CompletableFuture.java:440)
	at java.base/java.util.concurrent.CompletableFuture.get(CompletableFuture.java:2140)
	at org.apache.flink.streaming.api.operators.collect.CollectResultFetcher.getAccumulatorResults(CollectResultFetcher.java:185)
	... 12 more
Caused by: org.apache.flink.runtime.client.JobExecutionException: Job execution failed.
	at org.apache.flink.runtime.jobmaster.JobResult.toJobExecutionResult(JobResult.java:144)
	at org.apache.flink.runtime.minicluster.MiniClusterJobClient.lambda$getJobExecutionResult$3(MiniClusterJobClient.java:141)
	at java.base/java.util.concurrent.CompletableFuture.uniApplyNow(CompletableFuture.java:728)
	at java.base/java.util.concurrent.CompletableFuture.uniApplyStage(CompletableFuture.java:706)
	at java.base/java.util.concurrent.CompletableFuture.thenApply(CompletableFuture.java:2244)
	at org.apache.flink.runtime.minicluster.MiniClusterJobClient.getJobExecutionResult(MiniClusterJobClient.java:138)
	at org.apache.flink.streaming.api.operators.collect.CollectResultFetcher.getAccumulatorResults(CollectResultFetcher.java:184)
	... 12 more
Caused by: org.apache.flink.runtime.JobException: Recovery is suppressed by NoRestartBackoffTimeStrategy
	at org.apache.flink.runtime.executiongraph.failover.ExecutionFailureHandler.handleFailure(ExecutionFailureHandler.java:219)
	at org.apache.flink.runtime.executiongraph.failover.ExecutionFailureHandler.handleFailureAndReport(ExecutionFailureHandler.java:166)
	at org.apache.flink.runtime.executiongraph.failover.ExecutionFailureHandler.getFailureHandlingResult(ExecutionFailureHandler.java:121)
	at org.apache.flink.runtime.scheduler.DefaultScheduler.recordTaskFailure(DefaultScheduler.java:281)
	at org.apache.flink.runtime.scheduler.DefaultScheduler.handleTaskFailure(DefaultScheduler.java:272)
	at org.apache.flink.runtime.scheduler.DefaultScheduler.onTaskFailed(DefaultScheduler.java:265)
	at org.apache.flink.runtime.scheduler.SchedulerBase.onTaskExecutionStateUpdate(SchedulerBase.java:787)
	at org.apache.flink.runtime.scheduler.SchedulerBase.updateTaskExecutionState(SchedulerBase.java:764)
	at org.apache.flink.runtime.scheduler.SchedulerNG.updateTaskExecutionState(SchedulerNG.java:83)
	at org.apache.flink.runtime.jobmaster.JobMaster.updateTaskExecutionState(JobMaster.java:515)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.apache.flink.runtime.rpc.pekko.PekkoRpcActor.lambda$handleRpcInvocation$1(PekkoRpcActor.java:318)
	at org.apache.flink.runtime.concurrent.ClassLoadingUtils.runWithContextClassLoader(ClassLoadingUtils.java:83)
	at org.apache.flink.runtime.rpc.pekko.PekkoRpcActor.handleRpcInvocation(PekkoRpcActor.java:316)
	at org.apache.flink.runtime.rpc.pekko.PekkoRpcActor.handleRpcMessage(PekkoRpcActor.java:229)
	at org.apache.flink.runtime.rpc.pekko.FencedPekkoRpcActor.handleRpcMessage(FencedPekkoRpcActor.java:88)
	at org.apache.flink.runtime.rpc.pekko.PekkoRpcActor.handleMessage(PekkoRpcActor.java:174)
	at org.apache.pekko.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:33)
	at org.apache.pekko.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:29)
	at scala.PartialFunction.applyOrElse(PartialFunction.scala:127)
	at scala.PartialFunction.applyOrElse$(PartialFunction.scala:126)
	at org.apache.pekko.japi.pf.UnitCaseStatement.applyOrElse(CaseStatements.scala:29)
	at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:175)
	at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:176)
	at scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:176)
	at org.apache.pekko.actor.Actor.aroundReceive(Actor.scala:547)
	at org.apache.pekko.actor.Actor.aroundReceive$(Actor.scala:545)
	at org.apache.pekko.actor.AbstractActor.aroundReceive(AbstractActor.scala:229)
	at org.apache.pekko.actor.ActorCell.receiveMessage(ActorCell.scala:590)
	at org.apache.pekko.actor.ActorCell.invoke(ActorCell.scala:557)
	at org.apache.pekko.dispatch.Mailbox.processMailbox(Mailbox.scala:280)
	at org.apache.pekko.dispatch.Mailbox.run(Mailbox.scala:241)
	at org.apache.pekko.dispatch.Mailbox.exec(Mailbox.scala:253)
	at java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:507)
	at java.base/java.util.concurrent.ForkJoinPool$WorkQueue.topLevelExec(ForkJoinPool.java:1458)
	at java.base/java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:2034)
	at java.base/java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:189)
Caused by: java.lang.RuntimeException: Error while waiting for BeamPythonFunctionRunner flush
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.invokeFinishBundle(AbstractExternalPythonFunctionOperator.java:107)
	at org.apache.flink.streaming.api.operators.python.AbstractPythonFunctionOperator.advanceWatermark(AbstractPythonFunctionOperator.java:283)
	at org.apache.flink.streaming.api.operators.python.AbstractPythonFunctionOperator.processWatermark(AbstractPythonFunctionOperator.java:191)
	at org.apache.flink.streaming.runtime.tasks.OneInputStreamTask$StreamTaskNetworkOutput.emitWatermark(OneInputStreamTask.java:244)
	at org.apache.flink.streaming.runtime.watermarkstatus.StatusWatermarkValve.findAndOutputNewMinWatermarkAcrossAlignedSubpartitions(StatusWatermarkValve.java:283)
	at org.apache.flink.streaming.runtime.watermarkstatus.StatusWatermarkValve.inputWatermark(StatusWatermarkValve.java:184)
	at org.apache.flink.streaming.runtime.io.AbstractStreamTaskNetworkInput.processElement(AbstractStreamTaskNetworkInput.java:160)
	at org.apache.flink.streaming.runtime.io.AbstractStreamTaskNetworkInput.emitNext(AbstractStreamTaskNetworkInput.java:114)
	at org.apache.flink.streaming.runtime.io.StreamOneInputProcessor.processInput(StreamOneInputProcessor.java:65)
	at org.apache.flink.streaming.runtime.tasks.StreamTask.processInput(StreamTask.java:638)
	at org.apache.flink.streaming.runtime.tasks.mailbox.MailboxProcessor.runMailboxLoop(MailboxProcessor.java:231)
	at org.apache.flink.streaming.runtime.tasks.StreamTask.runMailboxLoop(StreamTask.java:973)
	at org.apache.flink.streaming.runtime.tasks.StreamTask.invoke(StreamTask.java:917)
	at org.apache.flink.runtime.taskmanager.Task.runWithSystemExitMonitoring(Task.java:970)
	at org.apache.flink.runtime.taskmanager.Task.restoreAndInvoke(Task.java:949)
	at org.apache.flink.runtime.taskmanager.Task.doRun(Task.java:763)
	at org.apache.flink.runtime.taskmanager.Task.run(Task.java:575)
	at java.base/java.lang.Thread.run(Thread.java:1575)
Caused by: java.lang.RuntimeException: Failed to close remote bundle
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.finishBundle(BeamPythonFunctionRunner.java:423)
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.flush(BeamPythonFunctionRunner.java:407)
	at org.apache.flink.streaming.api.operators.python.process.AbstractExternalPythonFunctionOperator.lambda$invokeFinishBundle$0(AbstractExternalPythonFunctionOperator.java:86)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	... 1 more
Caused by: java.util.concurrent.ExecutionException: java.lang.RuntimeException: Error received from SDK harness for instruction 4: Traceback (most recent call last):
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/apache_beam/runners/worker/sdk_worker.py", line 295, in _execute
    response = task()
               ^^^^^^
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/apache_beam/runners/worker/sdk_worker.py", line 370, in <lambda>
    lambda: self.create_worker().do_instruction(request), request)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/apache_beam/runners/worker/sdk_worker.py", line 629, in do_instruction
    return getattr(self, request_type)(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/apache_beam/runners/worker/sdk_worker.py", line 667, in process_bundle
    bundle_processor.process_bundle(instruction_id))
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/apache_beam/runners/worker/bundle_processor.py", line 1058, in process_bundle
    self.ops[element.transform_id].process_timer(
  File "pyflink/fn_execution/beam/beam_operations_fast.pyx", line 263, in pyflink.fn_execution.beam.beam_operations_fast.StatefulFunctionOperation.process_timer
  File "pyflink/fn_execution/beam/beam_operations_fast.pyx", line 272, in pyflink.fn_execution.beam.beam_operations_fast.StatefulFunctionOperation.process_timer
  File "pyflink/fn_execution/beam/beam_operations_fast.pyx", line 104, in pyflink.fn_execution.beam.beam_operations_fast.IntermediateOutputProcessor.process_outputs
  File "pyflink/fn_execution/beam/beam_operations_fast.pyx", line 169, in pyflink.fn_execution.beam.beam_operations_fast.FunctionOperation.process
  File "pyflink/fn_execution/beam/beam_operations_fast.pyx", line 193, in pyflink.fn_execution.beam.beam_operations_fast.FunctionOperation.process
  File "pyflink/fn_execution/beam/beam_operations_fast.pyx", line 65, in pyflink.fn_execution.beam.beam_operations_fast.IntermediateInputProcessor.has_next
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/pyflink/fn_execution/datastream/process/input_handler.py", line 94, in process_timer
    yield from _emit_results(
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/pyflink/fn_execution/datastream/process/input_handler.py", line 131, in _emit_results
    for result in results:
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/pyflink/fn_execution/datastream/process/input_handler.py", line 111, in _on_event_time
    yield from self._on_event_time_func(timestamp, key, namespace)
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/pyflink/fn_execution/datastream/window/window_operator.py", line 455, in on_event_time
    yield from self.emit_window_contents(self.trigger_context.window, contents)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/pyflink/fn_execution/datastream/window/window_operator.py", line 563, in emit_window_contents
    return self.window_function.process(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/pyflink/datastream/functions.py", line 1180, in process
    return self._wrapped_function.apply(key, window, input_data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/skmishra/repo/llms/experiments/flink/base.py", line 111, in apply
    sum(open_prices) / len(open_prices),
    ^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for +: 'int' and 'datetime.datetime'

	at java.base/java.util.concurrent.CompletableFuture.wrapInExecutionException(CompletableFuture.java:345)
	at java.base/java.util.concurrent.CompletableFuture.reportGet(CompletableFuture.java:440)
	at java.base/java.util.concurrent.CompletableFuture.get(CompletableFuture.java:2117)
	at org.apache.beam.sdk.util.MoreFutures.get(MoreFutures.java:61)
	at org.apache.beam.runners.fnexecution.control.SdkHarnessClient$BundleProcessor$ActiveBundle.close(SdkHarnessClient.java:504)
	at org.apache.beam.runners.fnexecution.control.DefaultJobBundleFactory$SimpleStageBundleFactory$1.close(DefaultJobBundleFactory.java:607)
	at org.apache.flink.streaming.api.runners.python.beam.BeamPythonFunctionRunner.finishBundle(BeamPythonFunctionRunner.java:421)
	... 7 more
Caused by: java.lang.RuntimeException: Error received from SDK harness for instruction 4: Traceback (most recent call last):
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/apache_beam/runners/worker/sdk_worker.py", line 295, in _execute
    response = task()
               ^^^^^^
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/apache_beam/runners/worker/sdk_worker.py", line 370, in <lambda>
    lambda: self.create_worker().do_instruction(request), request)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/apache_beam/runners/worker/sdk_worker.py", line 629, in do_instruction
    return getattr(self, request_type)(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/apache_beam/runners/worker/sdk_worker.py", line 667, in process_bundle
    bundle_processor.process_bundle(instruction_id))
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/apache_beam/runners/worker/bundle_processor.py", line 1058, in process_bundle
    self.ops[element.transform_id].process_timer(
  File "pyflink/fn_execution/beam/beam_operations_fast.pyx", line 263, in pyflink.fn_execution.beam.beam_operations_fast.StatefulFunctionOperation.process_timer
  File "pyflink/fn_execution/beam/beam_operations_fast.pyx", line 272, in pyflink.fn_execution.beam.beam_operations_fast.StatefulFunctionOperation.process_timer
  File "pyflink/fn_execution/beam/beam_operations_fast.pyx", line 104, in pyflink.fn_execution.beam.beam_operations_fast.IntermediateOutputProcessor.process_outputs
  File "pyflink/fn_execution/beam/beam_operations_fast.pyx", line 169, in pyflink.fn_execution.beam.beam_operations_fast.FunctionOperation.process
  File "pyflink/fn_execution/beam/beam_operations_fast.pyx", line 193, in pyflink.fn_execution.beam.beam_operations_fast.FunctionOperation.process
  File "pyflink/fn_execution/beam/beam_operations_fast.pyx", line 65, in pyflink.fn_execution.beam.beam_operations_fast.IntermediateInputProcessor.has_next
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/pyflink/fn_execution/datastream/process/input_handler.py", line 94, in process_timer
    yield from _emit_results(
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/pyflink/fn_execution/datastream/process/input_handler.py", line 131, in _emit_results
    for result in results:
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/pyflink/fn_execution/datastream/process/input_handler.py", line 111, in _on_event_time
    yield from self._on_event_time_func(timestamp, key, namespace)
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/pyflink/fn_execution/datastream/window/window_operator.py", line 455, in on_event_time
    yield from self.emit_window_contents(self.trigger_context.window, contents)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/pyflink/fn_execution/datastream/window/window_operator.py", line 563, in emit_window_contents
    return self.window_function.process(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/skmishra/repo/llms/experiments/.venv/lib/python3.11/site-packages/pyflink/datastream/functions.py", line 1180, in process
    return self._wrapped_function.apply(key, window, input_data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/skmishra/repo/llms/experiments/flink/base.py", line 111, in apply
    sum(open_prices) / len(open_prices),
    ^^^^^^^^^^^^^^^^
TypeError: unsupported operand type(s) for +: 'int' and 'datetime.datetime'

	at org.apache.beam.runners.fnexecution.control.FnApiControlClient$ResponseStreamObserver.onNext(FnApiControlClient.java:180)
	at org.apache.beam.runners.fnexecution.control.FnApiControlClient$ResponseStreamObserver.onNext(FnApiControlClient.java:160)
	at org.apache.beam.vendor.grpc.v1p48p1.io.grpc.stub.ServerCalls$StreamingServerCallHandler$StreamingServerCallListener.onMessage(ServerCalls.java:262)
	at org.apache.beam.vendor.grpc.v1p48p1.io.grpc.ForwardingServerCallListener.onMessage(ForwardingServerCallListener.java:33)
	at org.apache.beam.vendor.grpc.v1p48p1.io.grpc.Contexts$ContextualizedServerCallListener.onMessage(Contexts.java:76)
	at org.apache.beam.vendor.grpc.v1p48p1.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailableInternal(ServerCallImpl.java:332)
	at org.apache.beam.vendor.grpc.v1p48p1.io.grpc.internal.ServerCallImpl$ServerStreamListenerImpl.messagesAvailable(ServerCallImpl.java:315)
	at org.apache.beam.vendor.grpc.v1p48p1.io.grpc.internal.ServerImpl$JumpToApplicationThreadServerStreamListener$1MessagesAvailable.runInContext(ServerImpl.java:834)
	at org.apache.beam.vendor.grpc.v1p48p1.io.grpc.internal.ContextRunnable.run(ContextRunnable.java:37)
	at org.apache.beam.vendor.grpc.v1p48p1.io.grpc.internal.SerializingExecutor.run(SerializingExecutor.java:133)
	... 3 more

Traceback (most recent call last):
  File "/Users/skmishra/repo/llms/experiments/flink/utils.py", line 25, in write_xls
    df.to_excel(filename, index=False)
    ^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'to_excel'
[144.39999389648438, 137.42999267578125, 137.6999969482422, 141.00999450683594, 147.14999389648438, 149.86000061035156, 150.8800048828125, 150.3800048828125, 148.75, 159.72000122070312, 160.63999938964844, 168.60000610351562, 174.25, 174.72000122070312, 169.6300048828125, 180.5800018310547, 184.9199981689453, 181.22999572753906, 178.88999938964844, 178.47999572753906, 171.3000030517578, 171.13999938964844, 179.0, 180.00999450683594, 173.8800048828125, 172.97000122070312, 172.1699981689453, 175.10000610351562, 177.41000366210938, 173.1699981689453, 178.74000549316406, 180.5, 180.3300018310547, 171.80999755859375, 164.89999389648438, 183.8300018310547, 183.8000030517578, 179.83999633789062, 178.4600067138672, 176.83999633789062, 193.0, 202.72000122070312, 211.00999450683594, 205.3300018310547, 214.80999755859375, 213.8300018310547, 227.3000030517578, 203.5500030517578, 202.85000610351562, 198.8300018310547, 196.92999267578125, 193.8000030517578, 193.5, 185.61000061035156, 182.67999267578125, 187.69000244140625, 180.75999450683594, 182.8000030517578, 182.60000610351562, 181.22999572753906, 183.39999389648438, 187.24000549316406, 180.10000610351562, 182.0500030517578, 183.02000427246094, 172.69000244140625, 171.66000366210938, 171.60000610351562, 169.77999877929688, 170.9499969482422, 165.6999969482422, 164.44000244140625, 164.8800048828125, 164.4499969482422, 156.9600067138672, 154.25, 149.88999938964844, 153.5, 157.66000366210938, 155.13999938964844, 158.6300048828125, 160.77000427246094, 162.2899932861328, 151.3699951171875, 147.6199951171875, 150.7899932861328, 156.64999389648438, 157.6999969482422, 155.3300018310547, 154.08999633789062, 156.3699951171875, 153.3300018310547, 153.49000549316406, 159.69000244140625, 168.05999755859375, 169.72000122070312, 168.49000549316406, 165.8300018310547, 169.80999755859375, 173.13999938964844, 167.66000366210938, 174.5500030517578, 168.47999572753906, 168.75, 169.5, 171.0800018310547, 164.8300018310547, 167.1199951171875, 169.50999450683594, 169.4499969482422, 165.5500030517578, 161.5399932861328, 162.24000549316406, 162.66000366210938, 161.33999633789062, 159.22999572753906, 157.24000549316406, 166.82000732421875, 163.1999969482422, 163.39999389648438, 161.0, 160.74000549316406, 160.61000061035156, 166.4499969482422, 161.50999450683594, 164.5800018310547, 165.25999450683594, 174.0399932861328, 178.9499969482422, 180.41000366210938, 187.27999877929688, 187.11000061035156, 186.99000549316406, 185.5, 179.75, 169.8000030517578, 163.41000366210938, 155.80999755859375, 156.6999969482422, 157.0500030517578, 153.67999267578125, 144.75, 141.2899932861328, 144.58999633789062, 141.6999969482422, 153.60000610351562, 147.2899932861328, 137.10000610351562, 139.13999938964844, 136.44000244140625, 136.24000549316406, 136.47999572753906, 135.5, 137.99000549316406, 141.19000244140625, 143.25, 147.9600067138672, 149.3699951171875, 155.3699951171875, 162.0399932861328, 158.64999389648438, 159.83999633789062, 156.39999389648438, 158.27999877929688, 151.6999969482422, 150.42999267578125, 149.49000549316406, 148.99000549316406, 146.49000549316406, 143.3699951171875, 141.7100067138672, 139.1300048828125, 138.4499969482422, 143.0800018310547, 150.16000366210938, 151.5399932861328, 153.02999877929688, 154.44000244140625, 154.0399932861328, 152.82000732421875, 159.25, 157.4499969482422, 157.19000244140625, 159.63999938964844, 162.9499969482422, 168.67999267578125, 168.72999572753906, 165.0800018310547, 165.39999389648438, 163.10000610351562, 166.7899932861328, 171.2100067138672, 172.41000366210938, 173.60000610351562, 174.0500030517578, 172.00999450683594, 169.35000610351562, 168.89999389648438, 164.1300048828125, 158.27999877929688, 160.44000244140625, 158.00999450683594, 158.0, 156.74000549316406, 153.4499969482422, 155.19000244140625, 158.91000366210938, 160.27999877929688, 167.50999450683594, 153.1199951171875, 148.67999267578125, 144.5399932861328, 143.63999938964844, 143.0800018310547, 145.6300048828125, 150.1199951171875, 150.7100067138672, 148.57000732421875, 147.4499969482422, 144.49000549316406, 141.39999389648438, 137.35000610351562, 140.89999389648438, 139.75, 140.77000427246094, 140.27999877929688, 139.1300048828125, 142.35000610351562]
